
from matplotlib.colors import ListedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in viscm
parameters = {'xp': [1.2291944322885904, 15.686577994354849, 30.928398202273232, 41.057724594648285, 46.820832018097661, 31.313229240187304, 25.525867781487527],
              'yp': [-17.104696078108354, -28.200058582308117, -14.15860623697381, 0.15998870434009405, 18.000511032706118, 33.68105272368588, 20.750662701768483],
              'min_Jp': 10.0,
              'max_Jp': 70.0}

cm_data = [[ 0.06561609, 0.05086479, 0.21015313],
           [ 0.06978949, 0.05177616, 0.2152213 ],
           [ 0.07396908, 0.05263766, 0.22027146],
           [ 0.07815701, 0.05344897, 0.22530205],
           [ 0.08235676, 0.0542082 , 0.23031345],
           [ 0.08657621, 0.05490866, 0.23531161],
           [ 0.09080772, 0.05555889, 0.2402831 ],
           [ 0.0950524 , 0.05615883, 0.24522582],
           [ 0.09931112, 0.05670851, 0.25013756],
           [ 0.10358994, 0.05720219, 0.25502226],
           [ 0.10788511, 0.05764445, 0.25987225],
           [ 0.11219494, 0.0580378 , 0.2646826 ],
           [ 0.11651961, 0.05838269, 0.26945076],
           [ 0.12085917, 0.05867968, 0.27417408],
           [ 0.12521535, 0.05892728, 0.2788518 ],
           [ 0.12958849, 0.05912552, 0.28348163],
           [ 0.13397512, 0.05927902, 0.28805751],
           [ 0.13837479, 0.05938887, 0.29257678],
           [ 0.14278698, 0.0594563 , 0.29703679],
           [ 0.14721107, 0.05948264, 0.30143494],
           [ 0.15164637, 0.05946935, 0.30576869],
           [ 0.15609295, 0.05941694, 0.31003631],
           [ 0.16055036, 0.05932657, 0.31423564],
           [ 0.16501613, 0.05920215, 0.31836308],
           [ 0.16948943, 0.05904554, 0.32241661],
           [ 0.1739694 , 0.05885867, 0.32639436],
           [ 0.17845515, 0.05864352, 0.33029459],
           [ 0.18294581, 0.05840216, 0.33411577],
           [ 0.18744052, 0.05813667, 0.33785651],
           [ 0.19193842, 0.05784915, 0.34151564],
           [ 0.19643869, 0.05754171, 0.34509215],
           [ 0.20094053, 0.05721648, 0.34858523],
           [ 0.20544363, 0.05687484, 0.35199448],
           [ 0.20994665, 0.05651978, 0.35531912],
           [ 0.21444894, 0.05615331, 0.35855893],
           [ 0.21894988, 0.05577736, 0.36171384],
           [ 0.22344892, 0.0553938 , 0.36478394],
           [ 0.22794554, 0.05500441, 0.3677695 ],
           [ 0.2324393 , 0.05461088, 0.3706709 ],
           [ 0.2369298 , 0.05421483, 0.37348868],
           [ 0.24141666, 0.05381776, 0.3762235 ],
           [ 0.24589961, 0.05342107, 0.3788761 ],
           [ 0.25037837, 0.05302605, 0.38144736],
           [ 0.25485275, 0.05263388, 0.38393823],
           [ 0.25932258, 0.05224562, 0.38634972],
           [ 0.26378772, 0.05186224, 0.38868292],
           [ 0.26824788, 0.051485  , 0.39093899],
           [ 0.27270318, 0.05111429, 0.39311913],
           [ 0.27715363, 0.05075072, 0.39522456],
           [ 0.28159926, 0.05039478, 0.39725654],
           [ 0.28604011, 0.05004687, 0.39921633],
           [ 0.29047627, 0.04970728, 0.40110521],
           [ 0.29490785, 0.0493762 , 0.40292446],
           [ 0.29933497, 0.04905372, 0.40467536],
           [ 0.30375777, 0.04873988, 0.40635917],
           [ 0.3081764 , 0.04843459, 0.40797713],
           [ 0.31259105, 0.04813773, 0.40953049],
           [ 0.31700188, 0.04784908, 0.41102044],
           [ 0.32140865, 0.04756928, 0.41244836],
           [ 0.32581189, 0.04729728, 0.41381529],
           [ 0.3302119 , 0.04703253, 0.41512232],
           [ 0.33460889, 0.04677459, 0.41637054],
           [ 0.33900306, 0.04652296, 0.417561  ],
           [ 0.34339463, 0.0462771 , 0.41869473],
           [ 0.34778382, 0.04603645, 0.41977271],
           [ 0.35217083, 0.0458004 , 0.42079589],
           [ 0.35655588, 0.04556834, 0.42176517],
           [ 0.36093911, 0.04533977, 0.42268148],
           [ 0.36532024, 0.04511508, 0.42354601],
           [ 0.36970002, 0.04489237, 0.42435919],
           [ 0.37407866, 0.04467096, 0.42512178],
           [ 0.37845634, 0.04445013, 0.42583451],
           [ 0.38283325, 0.04422917, 0.42649807],
           [ 0.38720956, 0.04400736, 0.42711313],
           [ 0.39158545, 0.04378398, 0.42768031],
           [ 0.39596108, 0.0435583 , 0.42820021],
           [ 0.40033616, 0.04333069, 0.42867383],
           [ 0.40471118, 0.04309963, 0.4291014 ],
           [ 0.40908641, 0.0428641 , 0.4294833 ],
           [ 0.413462  , 0.04262338, 0.42982001],
           [ 0.41783808, 0.04237678, 0.43011199],
           [ 0.42221475, 0.04212359, 0.43035966],
           [ 0.42659214, 0.04186313, 0.43056341],
           [ 0.43097024, 0.04159504, 0.43072378],
           [ 0.43534888, 0.04131929, 0.43084142],
           [ 0.43972857, 0.0410342 , 0.4309162 ],
           [ 0.44410938, 0.04073912, 0.43094846],
           [ 0.44849139, 0.04043318, 0.43093847],
           [ 0.45287466, 0.04011166, 0.43088653],
           [ 0.45725925, 0.03977969, 0.4307929 ],
           [ 0.46164514, 0.03943704, 0.43065792],
           [ 0.46603216, 0.03908389, 0.43048213],
           [ 0.47042068, 0.03871897, 0.43026529],
           [ 0.47481072, 0.03834192, 0.43000763],
           [ 0.4792023 , 0.03795244, 0.42970934],
           [ 0.48359545, 0.03755024, 0.42937058],
           [ 0.48799016, 0.03713507, 0.42899155],
           [ 0.49238633, 0.03670703, 0.42857256],
           [ 0.49678396, 0.03626589, 0.42811375],
           [ 0.50118319, 0.0358111 , 0.42761505],
           [ 0.505584  , 0.03534254, 0.42707659],
           [ 0.50998635, 0.03486012, 0.42649851],
           [ 0.51439022, 0.03436381, 0.42588092],
           [ 0.51879556, 0.03385361, 0.42522394],
           [ 0.52320227, 0.03332973, 0.4245278 ],
           [ 0.52761039, 0.03279195, 0.42379243],
           [ 0.53201988, 0.03224031, 0.4230179 ],
           [ 0.53643068, 0.03167497, 0.42220431],
           [ 0.54084272, 0.03109613, 0.42135175],
           [ 0.54525591, 0.03050399, 0.42046032],
           [ 0.5496702 , 0.02989879, 0.41953006],
           [ 0.55408556, 0.02928066, 0.41856096],
           [ 0.55850186, 0.02865004, 0.41755314],
           [ 0.56291902, 0.02800731, 0.41650668],
           [ 0.56733692, 0.02735293, 0.41542166],
           [ 0.57175545, 0.0266874 , 0.41429815],
           [ 0.57617451, 0.02601126, 0.41313624],
           [ 0.58059413, 0.02532455, 0.41193566],
           [ 0.58501411, 0.02462821, 0.41069665],
           [ 0.58943428, 0.02392302, 0.40941936],
           [ 0.5938545 , 0.02320974, 0.40810385],
           [ 0.59827463, 0.02248917, 0.40675021],
           [ 0.60269453, 0.02176218, 0.4053585 ],
           [ 0.60711408, 0.02102953, 0.40392872],
           [ 0.61153338, 0.02029133, 0.40246038],
           [ 0.615952  , 0.01954948, 0.4009541 ],
           [ 0.6203698 , 0.01880507, 0.39940996],
           [ 0.62478658, 0.01805926, 0.39782804],
           [ 0.62920218, 0.01731328, 0.39620842],
           [ 0.6336164 , 0.01656842, 0.39455118],
           [ 0.63802916, 0.01582571, 0.39285618],
           [ 0.64244049, 0.01508569, 0.39112288],
           [ 0.6468499 , 0.01435095, 0.38935211],
           [ 0.65125717, 0.01362309, 0.38754395],
           [ 0.65566211, 0.01290375, 0.38569849],
           [ 0.66006449, 0.01219469, 0.38381582],
           [ 0.66446408, 0.01149771, 0.38189604],
           [ 0.66886067, 0.01081473, 0.37993922],
           [ 0.67325443, 0.01014608, 0.37794428],
           [ 0.67764478, 0.00949521, 0.37591228],
           [ 0.68203142, 0.00886446, 0.37384342],
           [ 0.68641409, 0.00825613, 0.37173783],
           [ 0.69079254, 0.00767256, 0.36959559],
           [ 0.6951665 , 0.00711623, 0.36741681],
           [ 0.6995357 , 0.00658971, 0.36520158],
           [ 0.70389986, 0.00609567, 0.36295001],
           [ 0.70825911, 0.00563519, 0.36066087],
           [ 0.71261282, 0.00521255, 0.3583353 ],
           [ 0.71696062, 0.00483103, 0.35597362],
           [ 0.7213022 , 0.00449379, 0.35357593],
           [ 0.72563724, 0.00420409, 0.35114235],
           [ 0.72996542, 0.00396532, 0.34867297],
           [ 0.73428641, 0.00378102, 0.34616791],
           [ 0.73859987, 0.00365483, 0.34362727],
           [ 0.74290545, 0.00359058, 0.34105115],
           [ 0.74720299, 0.00359135, 0.33843894],
           [ 0.75149216, 0.00366108, 0.33579055],
           [ 0.75577234, 0.00380506, 0.33310696],
           [ 0.76004315, 0.00402769, 0.33038828],
           [ 0.7643042 , 0.00433356, 0.32763461],
           [ 0.76855507, 0.00472743, 0.32484606],
           [ 0.77279534, 0.00521424, 0.32202272],
           [ 0.7770246 , 0.00579909, 0.3191647 ],
           [ 0.7812424 , 0.00648729, 0.3162721 ],
           [ 0.78544828, 0.00728434, 0.313345  ],
           [ 0.78964179, 0.00819594, 0.3103835 ],
           [ 0.79382244, 0.009228  , 0.30738769],
           [ 0.79798976, 0.01038664, 0.30435765],
           [ 0.80214324, 0.01167813, 0.30129337],
           [ 0.80628257, 0.01310822, 0.29819396],
           [ 0.81040698, 0.01468474, 0.29506059],
           [ 0.81451593, 0.01641476, 0.29189334],
           [ 0.81860884, 0.01830562, 0.28869229],
           [ 0.82268513, 0.02036492, 0.28545749],
           [ 0.8267442 , 0.02260054, 0.282189  ],
           [ 0.83078544, 0.02502063, 0.27888688],
           [ 0.83480819, 0.02763367, 0.27555117],
           [ 0.83881182, 0.03044843, 0.27218191],
           [ 0.84279563, 0.03347399, 0.26877914],
           [ 0.84675892, 0.0367198 , 0.26534288],
           [ 0.85070097, 0.04019563, 0.26187316],
           [ 0.85462103, 0.04377215, 0.25836997],
           [ 0.85851832, 0.04739628, 0.25483333],
           [ 0.86239205, 0.05107138, 0.25126323],
           [ 0.86624138, 0.0547972 , 0.24765967],
           [ 0.87006545, 0.05857364, 0.24402263],
           [ 0.87386338, 0.06240071, 0.24035208],
           [ 0.87763423, 0.06627854, 0.236648  ],
           [ 0.88137705, 0.07020733, 0.23291037],
           [ 0.88509086, 0.07418739, 0.22913914],
           [ 0.8887746 , 0.0782191 , 0.22533429],
           [ 0.89242735, 0.08230284, 0.22149389],
           [ 0.89604788, 0.08643932, 0.21761915],
           [ 0.89963498, 0.09062914, 0.21371039],
           [ 0.90318743, 0.09487295, 0.20976759],
           [ 0.90670399, 0.09917146, 0.20579078],
           [ 0.91018331, 0.10352542, 0.20177997],
           [ 0.91362402, 0.10793563, 0.19773526],
           [ 0.91702468, 0.11240295, 0.19365678],
           [ 0.92038378, 0.11692827, 0.18954473],
           [ 0.92369976, 0.12151264, 0.18539887],
           [ 0.92697094, 0.12615819, 0.1812146 ],
           [ 0.93019551, 0.13086507, 0.17699742],
           [ 0.93337166, 0.13563438, 0.17274802],
           [ 0.93649747, 0.14046727, 0.16846729],
           [ 0.93957096, 0.1453649 , 0.16415641],
           [ 0.94258984, 0.15032964, 0.15981321],
           [ 0.94555168, 0.15536372, 0.15543729],
           [ 0.94845436, 0.16046686, 0.15103628],
           [ 0.95129541, 0.16564043, 0.14661318],
           [ 0.95407211, 0.17088649, 0.14216988],
           [ 0.95678085, 0.17621006, 0.1377023 ],
           [ 0.9594195 , 0.18160891, 0.13322619],
           [ 0.96198509, 0.18708447, 0.12874888],
           [ 0.96447303, 0.19264302, 0.12426861],
           [ 0.96688049, 0.19828371, 0.11980253],
           [ 0.96920453, 0.20400604, 0.11536885],
           [ 0.97143911, 0.20981835, 0.11097072],
           [ 0.97358179, 0.21571723, 0.10663958],
           [ 0.9756282 , 0.22170471, 0.1023999 ],
           [ 0.97757207, 0.22778704, 0.09827466],
           [ 0.97941197, 0.2339573 , 0.09431643],
           [ 0.98113862, 0.2402277 , 0.09055293],
           [ 0.98275245, 0.24658628, 0.08705937],
           [ 0.98424372, 0.25304462, 0.08388359],
           [ 0.98561313, 0.25959021, 0.08111654],
           [ 0.98685202, 0.26623083, 0.07882982],
           [ 0.9879611 , 0.27295442, 0.07712379],
           [ 0.98893613, 0.27975937, 0.07608714],
           [ 0.9897765 , 0.28663727, 0.0758099 ],
           [ 0.99048451, 0.29357518, 0.07637091],
           [ 0.99106098, 0.30056394, 0.07782668],
           [ 0.99151315, 0.30758461, 0.0802102 ],
           [ 0.99184834, 0.31462021, 0.08352316],
           [ 0.99207802, 0.32164915, 0.08773695],
           [ 0.99221488, 0.32865054, 0.09279672],
           [ 0.99227264, 0.33560425, 0.0986287 ],
           [ 0.99227273, 0.3424818 , 0.10513843],
           [ 0.99222535, 0.34927298, 0.11224025],
           [ 0.99215391, 0.35595153, 0.11983087],
           [ 0.99206838, 0.3625111 , 0.127831  ],
           [ 0.99198834, 0.3689342 , 0.13615123],
           [ 0.99191815, 0.37522345, 0.14473659],
           [ 0.99188172, 0.38135847, 0.1535004 ],
           [ 0.99187195, 0.38735609, 0.16242414],
           [ 0.99190298, 0.39320806, 0.17145162],
           [ 0.99198604, 0.39891019, 0.18053545],
           [ 0.99211412, 0.40447776, 0.18967282],
           [ 0.99229101, 0.40991372, 0.19884048],
           [ 0.99251947, 0.41522178, 0.2080196 ],
           [ 0.99280136, 0.4204063 , 0.21719523],
           [ 0.99314154, 0.4254685 , 0.22634615],
           [ 0.99353555, 0.43041822, 0.23547549],
           [ 0.99398169, 0.43526205, 0.24458099],
           [ 0.99447923, 0.44000523, 0.25365879],
           [ 0.99502709, 0.44465297, 0.26270671]]

test_cm = ListedColormap(cm_data, name=__file__)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("viscm not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
