
from matplotlib.colors import ListedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in viscm
parameters = {'xp': [28.201888537784271, 41.069535596607807, 2.8565231188894415, -20.929127504996472, -30.287416275049935],
              'yp': [16.867201426024934, -20.565953654188945, -40.452317290552585, -21.345811051693403, 28.954991087344013],
              'min_Jp': 29.8113207547,
              'max_Jp': 80.0}

cm_data = [[ 0.49333322, 0.02527403, 0.01928125],
           [ 0.49597032, 0.02620568, 0.02800455],
           [ 0.49858019, 0.02720504, 0.03748274],
           [ 0.50116235, 0.02827394, 0.04728043],
           [ 0.50371631, 0.02941427, 0.05657657],
           [ 0.50624157, 0.0306265 , 0.06551304],
           [ 0.50873753, 0.0319123 , 0.07418991],
           [ 0.51120362, 0.03327618, 0.08266421],
           [ 0.51363932, 0.03472042, 0.09098518],
           [ 0.51604406, 0.0362474 , 0.09918936],
           [ 0.51841726, 0.03785946, 0.1073054 ],
           [ 0.52075809, 0.0395572 , 0.11536524],
           [ 0.52306614, 0.04132519, 0.12337365],
           [ 0.52534081, 0.04312889, 0.13134426],
           [ 0.52758149, 0.0449766 , 0.13928804],
           [ 0.52978755, 0.0468675 , 0.14721385],
           [ 0.53195834, 0.04880087, 0.15512889],
           [ 0.53409308, 0.05077573, 0.16304167],
           [ 0.53619092, 0.05279138, 0.17095914],
           [ 0.53825145, 0.05484812, 0.17887957],
           [ 0.54027398, 0.05694557, 0.18680603],
           [ 0.54225781, 0.05908342, 0.19474095],
           [ 0.54420223, 0.06126145, 0.20268618],
           [ 0.5461065 , 0.06347951, 0.21064308],
           [ 0.54796989, 0.06573755, 0.21861256],
           [ 0.54979165, 0.06803554, 0.22659516],
           [ 0.551571  , 0.07037356, 0.23459108],
           [ 0.55330717, 0.07275171, 0.24260022],
           [ 0.55499938, 0.07517017, 0.25062216],
           [ 0.55664666, 0.07762917, 0.25865779],
           [ 0.55824831, 0.08012899, 0.26670499],
           [ 0.55980361, 0.08266993, 0.27476193],
           [ 0.56131175, 0.08525233, 0.28282734],
           [ 0.5627719 , 0.08787653, 0.29089975],
           [ 0.56418323, 0.09054292, 0.29897749],
           [ 0.56554488, 0.09325191, 0.30705877],
           [ 0.56685603, 0.09600391, 0.31514161],
           [ 0.56811582, 0.09879936, 0.32322389],
           [ 0.5693234 , 0.10163871, 0.33130336],
           [ 0.5704779 , 0.10452238, 0.33937762],
           [ 0.57157847, 0.10745083, 0.34744416],
           [ 0.57262411, 0.11042458, 0.35550106],
           [ 0.57361382, 0.11344414, 0.36354614],
           [ 0.57454696, 0.1165098 , 0.37157546],
           [ 0.57542266, 0.11962196, 0.37958603],
           [ 0.57624009, 0.12278099, 0.38757482],
           [ 0.5769984 , 0.12598721, 0.39553866],
           [ 0.57769674, 0.12924095, 0.40347434],
           [ 0.57833431, 0.13254248, 0.41137856],
           [ 0.57891028, 0.13589201, 0.41924794],
           [ 0.57942385, 0.13928974, 0.42707906],
           [ 0.57987423, 0.14273582, 0.43486845],
           [ 0.58026064, 0.14623033, 0.44261257],
           [ 0.58058127, 0.14977414, 0.45031109],
           [ 0.58083622, 0.15336659, 0.45795755],
           [ 0.58102492, 0.15700751, 0.46554787],
           [ 0.58114669, 0.16069676, 0.47307839],
           [ 0.58120086, 0.16443416, 0.48054541],
           [ 0.58118679, 0.16821943, 0.48794526],
           [ 0.58110343, 0.17205262, 0.4952753 ],
           [ 0.5809494 , 0.17593397, 0.50253352],
           [ 0.58072534, 0.1798621 , 0.50971335],
           [ 0.58043074, 0.18383648, 0.51681115],
           [ 0.58006515, 0.18785651, 0.52382327],
           [ 0.57962805, 0.1919216 , 0.5307463 ],
           [ 0.57911725, 0.19603246, 0.53757994],
           [ 0.57853427, 0.20018682, 0.54431704],
           [ 0.5778788 , 0.20438381, 0.55095414],
           [ 0.57715064, 0.20862248, 0.55748785],
           [ 0.57634841, 0.21290277, 0.56391662],
           [ 0.57547216, 0.21722347, 0.57023674],
           [ 0.5745228 , 0.22158265, 0.57644346],
           [ 0.57350035, 0.22597913, 0.58253371],
           [ 0.5724037 , 0.23041253, 0.58850594],
           [ 0.57123302, 0.23488151, 0.59435702],
           [ 0.56998962, 0.23938381, 0.6000827 ],
           [ 0.5686738 , 0.24391799, 0.60568032],
           [ 0.56728407, 0.24848396, 0.61114915],
           [ 0.56582223, 0.25307913, 0.61648517],
           [ 0.56428928, 0.25770153, 0.62168558],
           [ 0.5626851 , 0.26235007, 0.62674881],
           [ 0.56100957, 0.26702366, 0.63167337],
           [ 0.55926506, 0.2717194 , 0.63645598],
           [ 0.55745239, 0.27643558, 0.64109496],
           [ 0.55557048, 0.28117189, 0.64559002],
           [ 0.55362257, 0.28592491, 0.64993817],
           [ 0.55160984, 0.29069281, 0.65413817],
           [ 0.54953187, 0.29547491, 0.65818977],
           [ 0.54739157, 0.30026822, 0.66209115],
           [ 0.54519072, 0.30507065, 0.66584143],
           [ 0.54292951, 0.30988122, 0.66944055],
           [ 0.54061086, 0.31469718, 0.67288758],
           [ 0.53823693, 0.31951637, 0.67618221],
           [ 0.53580849, 0.32433762, 0.67932469],
           [ 0.53332869, 0.32915826, 0.68231486],
           [ 0.53079992, 0.33397622, 0.68515303],
           [ 0.52822356, 0.33879016, 0.68783987],
           [ 0.52560302, 0.34359752, 0.69037596],
           [ 0.52294084, 0.3483964 , 0.69276222],
           [ 0.52023919, 0.35318521, 0.6949998 ],
           [ 0.51750146, 0.3579617 , 0.69709   ],
           [ 0.51473044, 0.36272409, 0.69903433],
           [ 0.51192913, 0.36747058, 0.70083451],
           [ 0.50910069, 0.37219935, 0.70249245],
           [ 0.50624835, 0.37690863, 0.70401025],
           [ 0.50337559, 0.38159665, 0.70539023],
           [ 0.5004854 , 0.38626197, 0.70663482],
           [ 0.49758161, 0.39090278, 0.70774672],
           [ 0.49466773, 0.39551756, 0.70872878],
           [ 0.49174669, 0.40010521, 0.70958386],
           [ 0.48882292, 0.40466384, 0.71031531],
           [ 0.48589967, 0.40919235, 0.71092635],
           [ 0.48297978, 0.41368992, 0.71142018],
           [ 0.48006819, 0.41815467, 0.71180081],
           [ 0.47716776, 0.42258593, 0.71207169],
           [ 0.47428116, 0.42698317, 0.71223629],
           [ 0.47141349, 0.43134465, 0.7122991 ],
           [ 0.46856746, 0.43566997, 0.71226384],
           [ 0.4657453 , 0.43995897, 0.71213405],
           [ 0.46295164, 0.44421034, 0.71191443],
           [ 0.46018977, 0.44842351, 0.71160925],
           [ 0.45746095, 0.45259891, 0.7112218 ],
           [ 0.45476848, 0.45673599, 0.71075644],
           [ 0.45211747, 0.46083337, 0.7102187 ],
           [ 0.44950744, 0.46489238, 0.70961112],
           [ 0.44694065, 0.468913  , 0.70893773],
           [ 0.44442146, 0.47289424, 0.70820398],
           [ 0.44195102, 0.47683663, 0.70741353],
           [ 0.43952952, 0.48074111, 0.70656937],
           [ 0.43715841, 0.48460801, 0.70567536],
           [ 0.43484161, 0.4884365 , 0.70473722],
           [ 0.43257847, 0.49222785, 0.70375758],
           [ 0.43036863, 0.49598309, 0.70273931],
           [ 0.42821256, 0.49970288, 0.70168588],
           [ 0.4261117 , 0.50338738, 0.70060162],
           [ 0.42406714, 0.50703688, 0.69949075],
           [ 0.42207617, 0.51065328, 0.69835454],
           [ 0.4201382 , 0.51423748, 0.69719593],
           [ 0.41825239, 0.51779045, 0.69601774],
           [ 0.41641802, 0.52131302, 0.69482297],
           [ 0.41463605, 0.52480529, 0.69361617],
           [ 0.41290206, 0.52826957, 0.69239728],
           [ 0.41121416, 0.531707  , 0.69116841],
           [ 0.40957026, 0.53511877, 0.68993152],
           [ 0.40796798, 0.53850613, 0.68868837],
           [ 0.40640477, 0.54187033, 0.68744052],
           [ 0.40487816, 0.54521252, 0.68618967],
           [ 0.40338673, 0.54853342, 0.6849385 ],
           [ 0.4019253 , 0.55183515, 0.68368606],
           [ 0.40049051, 0.55511907, 0.6824331 ],
           [ 0.39907885, 0.55838655, 0.68118015],
           [ 0.39768669, 0.56163894, 0.67992752],
           [ 0.39631023, 0.56487762, 0.67867534],
           [ 0.39494561, 0.56810395, 0.67742348],
           [ 0.39358885, 0.57131929, 0.67617164],
           [ 0.39223591, 0.574525  , 0.67491928],
           [ 0.39088271, 0.5777224 , 0.67366566],
           [ 0.38952513, 0.58091281, 0.67240984],
           [ 0.38815903, 0.58409751, 0.67115066],
           [ 0.38678029, 0.58727774, 0.66988677],
           [ 0.38538481, 0.59045474, 0.66861665],
           [ 0.38396854, 0.59362968, 0.66733856],
           [ 0.38252747, 0.59680369, 0.66605063],
           [ 0.38105771, 0.59997786, 0.66475077],
           [ 0.37955543, 0.60315324, 0.66343678],
           [ 0.37801693, 0.60633079, 0.6621063 ],
           [ 0.37643862, 0.60951145, 0.66075682],
           [ 0.37481705, 0.61269607, 0.65938573],
           [ 0.37314892, 0.61588546, 0.65799031],
           [ 0.37143109, 0.61908035, 0.65656771],
           [ 0.36966058, 0.62228142, 0.65511505],
           [ 0.36783458, 0.62548926, 0.65362934],
           [ 0.36595048, 0.62870442, 0.65210754],
           [ 0.36400581, 0.63192735, 0.65054658],
           [ 0.36199831, 0.63515846, 0.64894334],
           [ 0.3599259 , 0.63839809, 0.64729471],
           [ 0.35778669, 0.64164649, 0.64559753],
           [ 0.35558153, 0.64490317, 0.64385093],
           [ 0.35330807, 0.64816852, 0.64205105],
           [ 0.35096364, 0.65144298, 0.64019365],
           [ 0.34854706, 0.6547266 , 0.63827567],
           [ 0.34605733, 0.65801934, 0.63629412],
           [ 0.34349359, 0.66132111, 0.63424603],
           [ 0.34085514, 0.6646318 , 0.63212848],
           [ 0.33814144, 0.66795122, 0.62993863],
           [ 0.33535781, 0.67127773, 0.62767864],
           [ 0.33249991, 0.67461213, 0.62534227],
           [ 0.32956647, 0.67795441, 0.62292591],
           [ 0.32655747, 0.68130425, 0.62042697],
           [ 0.32347299, 0.6846613 , 0.61784294],
           [ 0.32031321, 0.68802519, 0.61517136],
           [ 0.31708624, 0.69139371, 0.61241664],
           [ 0.31378694, 0.69476779, 0.60957168],
           [ 0.31041414, 0.69814735, 0.60663278],
           [ 0.30696838, 0.70153195, 0.60359773],
           [ 0.30345031, 0.70492112, 0.60046438],
           [ 0.29986888, 0.70831267, 0.59723786],
           [ 0.296221  , 0.71170698, 0.59391274],
           [ 0.29250391, 0.71510435, 0.59048379],
           [ 0.28871858, 0.7185043 , 0.586949  ],
           [ 0.28486743, 0.72190605, 0.58330762],
           [ 0.28096333, 0.72530685, 0.57956831],
           [ 0.27699509, 0.72870868, 0.57571802],
           [ 0.27296401, 0.73211106, 0.5717548 ],
           [ 0.26887151, 0.7355135 , 0.5676767 ],
           [ 0.26473391, 0.73891283, 0.56349536],
           [ 0.26054058, 0.74231087, 0.55919767],
           [ 0.25629147, 0.7457075 , 0.55477993],
           [ 0.25198849, 0.74910224, 0.55024007],
           [ 0.24765189, 0.75249156, 0.54559309],
           [ 0.24326715, 0.75587794, 0.54082123],
           [ 0.23883604, 0.75926104, 0.5359216 ],
           [ 0.23436661, 0.76263956, 0.53089703],
           [ 0.22987216, 0.76601149, 0.52575522],
           [ 0.22534086, 0.76937884, 0.52047927],
           [ 0.22077621, 0.77274118, 0.51506652],
           [ 0.21619895, 0.77609561, 0.50953081],
           [ 0.2116031 , 0.77944336, 0.50385933],
           [ 0.20698746, 0.7827849 , 0.49804314],
           [ 0.20236619, 0.78611861, 0.49208793],
           [ 0.19775223, 0.78944319, 0.48599769],
           [ 0.19313651, 0.79276045, 0.47975307],
           [ 0.18852921, 0.79606961, 0.47335316],
           [ 0.18395865, 0.79936774, 0.4668152 ],
           [ 0.17941062, 0.8026575 , 0.46011073],
           [ 0.17489479, 0.80593855, 0.45323454],
           [ 0.17044936, 0.80920726, 0.44621117],
           [ 0.16605975, 0.81246657, 0.43900623],
           [ 0.16173855, 0.81571622, 0.43161241],
           [ 0.15752747, 0.81895279, 0.42405399],
           [ 0.15341716, 0.82217893, 0.41629474],
           [ 0.1494232 , 0.82539453, 0.40832364],
           [ 0.14559349, 0.82859613, 0.40016702],
           [ 0.14191993, 0.8317866 , 0.39177997],
           [ 0.13842671, 0.83496541, 0.38315319],
           [ 0.13516081, 0.83812976, 0.37430595],
           [ 0.13211959, 0.84128228, 0.36518748],
           [ 0.12933654, 0.84442182, 0.35579217],
           [ 0.12684957, 0.84754685, 0.34612048],
           [ 0.12466351, 0.85065931, 0.33611812],
           [ 0.12281796, 0.85375743, 0.32578338],
           [ 0.12133452, 0.85684116, 0.31508432],
           [ 0.12022263, 0.85991164, 0.30396065],
           [ 0.11952138, 0.86296639, 0.29241282],
           [ 0.11923006, 0.86600702, 0.2803543 ],
           [ 0.11936084, 0.86903332, 0.26771942],
           [ 0.11993359, 0.87204344, 0.2544682 ],
           [ 0.12093462, 0.87503932, 0.24044629],
           [ 0.12237207, 0.87801937, 0.22555675],
           [ 0.12423643, 0.88098381, 0.20961037],
           [ 0.12651228, 0.88393343, 0.1923184 ],
           [ 0.12919623, 0.88686588, 0.17339217],
           [ 0.13226114, 0.88978323, 0.15215518],
           [ 0.13569253, 0.89268428, 0.12762763],
           [ 0.13946934, 0.89556889, 0.09772307],
           [ 0.14356906, 0.8984379 , 0.05644609]]

test_cm = ListedColormap(cm_data, name=__file__)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("viscm not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
